##### Back to [Index](README.md)

---

##### Configuring Kube-Proxy


```bash
sudo mv kube-proxy.kubeconfig /var/lib/kube-proxy/kubeconfig

```

- Create the kube-proxy config file:
```bash
cat << EOF | sudo tee /var/lib/kube-proxy/kube-proxy-config.yaml
kind: KubeProxyConfiguration
apiVersion: kubeproxy.config.k8s.io/v1alpha1
clientConnection:
  kubeconfig: "/var/lib/kube-proxy/kubeconfig"
mode: "iptables"
clusterCIDR: "10.200.0.0/16"
EOF
```

Create the kube-proxy unit file:
```bash
cat << EOF | sudo tee /etc/systemd/system/kube-proxy.service
[Unit]
Description=Kubernetes Kube Proxy
Documentation=https://github.com/kubernetes/kubernetes

[Service]
ExecStart=/usr/local/bin/kube-proxy \\
  --config=/var/lib/kube-proxy/kube-proxy-config.yaml
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
EOF
```

```bash
sudo systemctl daemon-reload
sudo systemctl enable containerd kubelet kube-proxy
sudo systemctl start containerd kubelet kube-proxy
sudo systemctl status containerd kubelet kube-proxy
```

- On any controller node run:
```bash
~$ kubectl get nodes
NAME                        STATUS     ROLES     AGE       VERSION
tanalam3c.mylabserver.com   NotReady   <none>    2m        v1.10.2
tanalam4c.mylabserver.com   NotReady   <none>    2m        v1.10.2
```

